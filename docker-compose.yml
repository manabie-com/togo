version: '3'

networks:
  development-net:
volumes:
  mongodb:
    driver: local

services:
# =========================================== DEFINE MONGODB DEVELOPMENT AND DASHBOARD TOOL ======================================
  mongo:
    image: mongo:4.4.12-rc1-focal
    restart: always
    ports:
      - 27017:27017
    volumes:
      - mongodb:/data/db
    networks:
      - development-net
  mongo-express:  
    image: mongo-express
    restart: always
    ports:
      - 8081:8081
    depends_on:
      - mongo
    environment:
      - ME_CONFIG_MONGODB_ENABLE_ADMIN=true
      - ME_CONFIG_MONGODB_URL=mongodb://mongo:27017
    networks:
      - development-net
      
  # =========================================== DEFINE BACKEND SERVICE ======================================
  backend-services:
    image: 'node:16-alpine'
    restart: always
    volumes:
      - ./:/backend
    networks:
      - development-net
    environment:  
      MONGO_URI: 'mongodb://mongo:27017'                  # Docker DNS service
      PORT: 9200
    ports: 
      - 9200:9200
    build: .
    